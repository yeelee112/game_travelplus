<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quiz Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body {
      background: #f7f7fa;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      color: #3a3a7c;
      margin-top: 40px;
      margin-bottom: 20px;
      letter-spacing: 1px;
    }
    #groupContainer, #formContainer, #doneContainer {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(60,60,120,0.08);
      padding: 32px 24px;
      margin-top: 24px;
      min-width: 320px;
      max-width: 90vw;
      text-align: center;
    }
    label {
      font-weight: 500;
      color: #444;
      margin-right: 8px;
    }
    select, input[type="text"] {
      padding: 8px 12px;
      border: 1px solid #bdbdbd;
      border-radius: 6px;
      font-size: 16px;
      margin-bottom: 12px;
      width: 70%;
      box-sizing: border-box;
      transition: border-color 0.2s;
    }
    select:focus, input[type="text"]:focus {
      border-color: #3a3a7c;
      outline: none;
    }
    button {
      background: linear-gradient(90deg, #87AF45 0%, #009cde 100%);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 24px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 8px;
      box-shadow: 0 2px 8px rgba(60,60,120,0.08);
      transition: background 0.2s;
    }
    button:hover {
      background: linear-gradient(90deg, #57702e 0%, #006c9a 100%);
    }
    #questionLabel {
      font-size: 18px;
      font-weight: 500;
      color: #3a3a7c;
      margin-bottom: 16px;
    }
    #doneContainer h2 {
      color: #3a3a7c;
      margin-bottom: 8px;
    }
    #doneContainer p {
      font-size: 17px;
      color: #444;
    }
    @media (max-width: 600px) {
      h1 {
        font-size: 24px;
        margin-top: 20px;
        margin-bottom: 10px;
      }
      #groupContainer, #formContainer, #doneContainer {
        padding: 24px 12px;
        min-width: unset;
        width: 100vw;
        margin-top: 8px;
      }
      select, input[type="text"] {
        font-size: 20px;
        width: 100%;
        padding: 16px 12px;
      }
      button {
        font-size: 20px;
        padding: 18px 0;
        width: 100%;
        margin-top: 14px;
      }
      #questionLabel {
        font-size: 20px;
        margin-bottom: 12px;
      }
      #doneContainer h2 {
        font-size: 22px;
      }
      #doneContainer p {
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
  <h1>ƒêu·ªïi h√¨nh b·∫Øt ch·ªØ</h1>

  <!-- Ch·ªçn nh√≥m -->
  <div id="groupContainer">
    <label>Ch·ªçn nh√≥m: </label>
    <select id="groupSelect">
      <option value="">--Ch·ªçn ƒëi--</option>
      <option value="K·∫ø To√°n">K·∫ø To√°n</option>
      <option value="Nh√¢n S·ª±">Nh√¢n S·ª±</option>
      <option value="VP HCM">ƒêi·ªÅu h√†nh VP HCM</option>
      <option value="VP ƒê√† N·∫µng">VP ƒê√† N·∫µng</option>
      <option value="VP H√† N·ªôi">VP H√† N·ªôi</option>

    </select>
    <button onclick="startQuiz()">B·∫Øt ƒë·∫ßu</button>
  </div>

  <!-- Form nh·∫≠p c√¢u tr·∫£ l·ªùi -->
  <div id="formContainer" style="display:none;">
    <p id="questionLabel">C√¢u 1:</p>
    <input type="text" id="answerInput" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..." />
    <button onclick="nextQuestion()">Ti·∫øp theo</button>
  </div>

  <!-- Ho√†n t·∫•t -->
  <div id="doneContainer" style="display:none;">
    <h2>Ho√†n t·∫•t!</h2>
    <p>C·∫£m ∆°n nh√≥m ƒë√£ tham gia üéâ</p>
  </div>

  <script>
    const { createClient } = supabase
    const supabaseUrl = "https://kmmrxmvvgpczbdisqztz.supabase.co"   // thay b·∫±ng URL
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImttbXJ4bXZ2Z3BjemJkaXNxenR6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4MzY2NzIsImV4cCI6MjA3MTQxMjY3Mn0.7GoZNFw37gmtCObTpE5X_IVMBtrMcasglt-SQfO68og"                     // thay b·∫±ng anon key
    
    const db = createClient(supabaseUrl, supabaseKey)

    const totalQuestions = 3
    let currentIndex = 0
    let currentGroup = ""

    function startQuiz() {
      const selected = document.getElementById("groupSelect").value
      if (!selected) {
        alert("Vui l√≤ng ch·ªçn nh√≥m tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu!")
        return
      }
      currentGroup = selected
      document.getElementById("groupContainer").style.display = "none"
      document.getElementById("formContainer").style.display = "block"
      updateLabel()
    }

    function updateLabel() {
      document.getElementById("questionLabel").innerText = `C√¢u ${currentIndex + 1}:`
    }

    async function nextQuestion() {
      const input = document.getElementById("answerInput")
      const answer = input.value.trim()

      // L∆∞u v√†o Supabase
      const { data, error } = await db
        .from("quiz_results")
        .insert([{
          group_name: currentGroup,
          question_number: currentIndex + 1,
          answer: answer
        }])

      if (error) {
        console.error(error)
        alert("L·ªói khi l∆∞u d·ªØ li·ªáu!")
        return
      }

      console.log("ƒê√£ l∆∞u:", data)

      currentIndex++
      input.value = ""

      if (currentIndex >= totalQuestions) {
        document.getElementById("formContainer").style.display = "none"
        document.getElementById("doneContainer").style.display = "block"
      } else {
        updateLabel()
      }
    }
  </script>
</body>
</html>